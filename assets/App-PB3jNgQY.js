import{j as h,r as q}from"./index-sq-rudQe.js";const Ye=({config:P,onConfigChange:D})=>{const j=(c,s)=>{D({...P,[c]:s})},T=c=>{const s=c.replace(/\s/g,"").toUpperCase();j("secret",s)};return h.jsxs("div",{className:"totp-form",children:[h.jsx("h2",{children:"Configuration"}),h.jsxs("form",{onSubmit:c=>c.preventDefault(),children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"secret",children:"Secret Key (Base32)"}),h.jsx("input",{type:"text",id:"secret",value:P.secret,onChange:c=>T(c.target.value),placeholder:"Enter your base32 secret key",className:"form-input"}),h.jsx("small",{className:"form-help",children:"Enter the base32 encoded secret key from your TOTP setup"})]}),h.jsxs("div",{className:"form-row",children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"digits",children:"Digits"}),h.jsxs("select",{id:"digits",value:P.digits,onChange:c=>j("digits",parseInt(c.target.value)),className:"form-select",children:[h.jsx("option",{value:6,children:"6 digits"}),h.jsx("option",{value:8,children:"8 digits"})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"period",children:"Period (seconds)"}),h.jsxs("select",{id:"period",value:P.period,onChange:c=>j("period",parseInt(c.target.value)),className:"form-select",children:[h.jsx("option",{value:30,children:"30 seconds"}),h.jsx("option",{value:60,children:"60 seconds"})]})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"algorithm",children:"Algorithm"}),h.jsxs("select",{id:"algorithm",value:P.algorithm,onChange:c=>j("algorithm",c.target.value),className:"form-select",children:[h.jsx("option",{value:"sha1",children:"sha1"}),h.jsx("option",{value:"sha256",children:"sha256"}),h.jsx("option",{value:"sha512",children:"sha512"})]})]})]})]})},Le=({totp:P,timeRemaining:D,period:j,isValid:T})=>{const c=(j-D)/j*100;return T?h.jsx("div",{className:"totp-display",children:h.jsxs("div",{className:"display-container",children:[h.jsx("h2",{children:"Generated TOTP"}),h.jsx("div",{className:"totp-code",children:h.jsx("span",{className:"code-text",children:P})}),h.jsxs("div",{className:"timer-section",children:[h.jsxs("div",{className:"timer-display",children:[h.jsxs("span",{className:"time-remaining",children:[D,"s"]}),h.jsx("span",{className:"time-label",children:"remaining"})]}),h.jsx("div",{className:"progress-bar",children:h.jsx("div",{className:"progress-fill",style:{width:`${c}%`}})})]}),h.jsx("div",{className:"refresh-info",children:h.jsxs("p",{children:["Code refreshes automatically every ",j," seconds"]})})]})}):h.jsx("div",{className:"totp-display",children:h.jsxs("div",{className:"display-container",children:[h.jsx("h2",{children:"Generated TOTP"}),h.jsx("div",{className:"totp-placeholder",children:h.jsx("p",{children:"Enter a valid secret key to generate TOTP codes"})})]})})};var qe={exports:{}};/**
 * @otplib/preset-browser
 *
 * @author Gerald Yeo <contact@fusedthought.com>
 * @version: 12.0.1
 * @license: MIT
 **/var Ze;function et(){return Ze||(Ze=1,(function(P,D){(function(j,T){P.exports=T()})(window,(function(){return(function(j){var T={};function c(s){if(T[s])return T[s].exports;var f=T[s]={i:s,l:!1,exports:{}};return j[s].call(f.exports,f,f.exports,c),f.l=!0,f.exports}return c.m=j,c.c=T,c.d=function(s,f,y){c.o(s,f)||Object.defineProperty(s,f,{enumerable:!0,get:y})},c.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},c.t=function(s,f){if(1&f&&(s=c(s)),8&f||4&f&&typeof s=="object"&&s&&s.__esModule)return s;var y=Object.create(null);if(c.r(y),Object.defineProperty(y,"default",{enumerable:!0,value:s}),2&f&&typeof s!="string")for(var H in s)c.d(y,H,(function(g){return s[g]}).bind(null,H));return y},c.n=function(s){var f=s&&s.__esModule?function(){return s.default}:function(){return s};return c.d(f,"a",f),f},c.o=function(s,f){return Object.prototype.hasOwnProperty.call(s,f)},c.p="",c(c.s=12)})([function(j,T,c){var s;j.exports=(s=s||(function(f,y){var H=Object.create||(function(){function a(){}return function(l){var p;return a.prototype=l,p=new a,a.prototype=null,p}})(),g={},m=g.lib={},x=m.Base={extend:function(a){var l=H(this);return a&&l.mixIn(a),l.hasOwnProperty("init")&&this.init!==l.init||(l.init=function(){l.$super.init.apply(this,arguments)}),l.init.prototype=l,l.$super=this,l},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var l in a)a.hasOwnProperty(l)&&(this[l]=a[l]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},o=m.WordArray=x.extend({init:function(a,l){a=this.words=a||[],this.sigBytes=l??4*a.length},toString:function(a){return(a||w).stringify(this)},concat:function(a){var l=this.words,p=a.words,v=this.sigBytes,b=a.sigBytes;if(this.clamp(),v%4)for(var E=0;E<b;E++){var C=p[E>>>2]>>>24-E%4*8&255;l[v+E>>>2]|=C<<24-(v+E)%4*8}else for(E=0;E<b;E+=4)l[v+E>>>2]=p[E>>>2];return this.sigBytes+=b,this},clamp:function(){var a=this.words,l=this.sigBytes;a[l>>>2]&=4294967295<<32-l%4*8,a.length=f.ceil(l/4)},clone:function(){var a=x.clone.call(this);return a.words=this.words.slice(0),a},random:function(a){for(var l,p=[],v=function(C){C=C;var N=987654321,A=4294967295;return function(){var R=((N=36969*(65535&N)+(N>>16)&A)<<16)+(C=18e3*(65535&C)+(C>>16)&A)&A;return R/=4294967296,(R+=.5)*(f.random()>.5?1:-1)}},b=0;b<a;b+=4){var E=v(4294967296*(l||f.random()));l=987654071*E(),p.push(4294967296*E()|0)}return new o.init(p,a)}}),k=g.enc={},w=k.Hex={stringify:function(a){for(var l=a.words,p=a.sigBytes,v=[],b=0;b<p;b++){var E=l[b>>>2]>>>24-b%4*8&255;v.push((E>>>4).toString(16)),v.push((15&E).toString(16))}return v.join("")},parse:function(a){for(var l=a.length,p=[],v=0;v<l;v+=2)p[v>>>3]|=parseInt(a.substr(v,2),16)<<24-v%8*4;return new o.init(p,l/2)}},_=k.Latin1={stringify:function(a){for(var l=a.words,p=a.sigBytes,v=[],b=0;b<p;b++){var E=l[b>>>2]>>>24-b%4*8&255;v.push(String.fromCharCode(E))}return v.join("")},parse:function(a){for(var l=a.length,p=[],v=0;v<l;v++)p[v>>>2]|=(255&a.charCodeAt(v))<<24-v%4*8;return new o.init(p,l)}},O=k.Utf8={stringify:function(a){try{return decodeURIComponent(escape(_.stringify(a)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(a){return _.parse(unescape(encodeURIComponent(a)))}},S=m.BufferedBlockAlgorithm=x.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(a){typeof a=="string"&&(a=O.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(a){var l=this._data,p=l.words,v=l.sigBytes,b=this.blockSize,E=v/(4*b),C=(E=a?f.ceil(E):f.max((0|E)-this._minBufferSize,0))*b,N=f.min(4*C,v);if(C){for(var A=0;A<C;A+=b)this._doProcessBlock(p,A);var R=p.splice(0,C);l.sigBytes-=N}return new o.init(R,N)},clone:function(){var a=x.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0}),d=(m.Hasher=S.extend({cfg:x.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){S.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(l,p){return new a.init(p).finalize(l)}},_createHmacHelper:function(a){return function(l,p){return new d.HMAC.init(a,p).finalize(l)}}}),g.algo={});return g})(Math),s)},function(j,T,c){var s,f,y,H;j.exports=(s=c(0),y=(f=s).lib.Base,H=f.enc.Utf8,void(f.algo.HMAC=y.extend({init:function(g,m){g=this._hasher=new g.init,typeof m=="string"&&(m=H.parse(m));var x=g.blockSize,o=4*x;m.sigBytes>o&&(m=g.finalize(m)),m.clamp();for(var k=this._oKey=m.clone(),w=this._iKey=m.clone(),_=k.words,O=w.words,S=0;S<x;S++)_[S]^=1549556828,O[S]^=909522486;k.sigBytes=w.sigBytes=o,this.reset()},reset:function(){var g=this._hasher;g.reset(),g.update(this._iKey)},update:function(g){return this._hasher.update(g),this},finalize:function(g){var m=this._hasher,x=m.finalize(g);return m.reset(),m.finalize(this._oKey.clone().concat(x))}})))},function(j,T,c){var s;j.exports=(s=c(0),s.enc.Hex)},function(j,T,c){var s,f,y,H,g,m;j.exports=(m=c(0),f=(s=m).lib,y=f.Base,H=f.WordArray,(g=s.x64={}).Word=y.extend({init:function(x,o){this.high=x,this.low=o}}),g.WordArray=y.extend({init:function(x,o){x=this.words=x||[],this.sigBytes=o??8*x.length},toX32:function(){for(var x=this.words,o=x.length,k=[],w=0;w<o;w++){var _=x[w];k.push(_.high),k.push(_.low)}return H.create(k,this.sigBytes)},clone:function(){for(var x=y.clone.call(this),o=x.words=this.words.slice(0),k=o.length,w=0;w<k;w++)o[w]=o[w].clone();return x}}),m)},function(j,T,c){var s;j.exports=(s=c(0),c(9),c(1),s.HmacSHA1)},function(j,T,c){var s;j.exports=(s=c(0),c(10),c(1),s.HmacSHA256)},function(j,T,c){var s;j.exports=(s=c(0),c(3),c(11),c(1),s.HmacSHA512)},function(j,T){function c(s,f){var y=s.indexOf(f);if(y===-1)throw new Error("Invalid character found: "+f);return y}j.exports=function(s,f){var y;switch(f){case"RFC3548":case"RFC4648":y="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",s=s.replace(/=+$/,"");break;case"RFC4648-HEX":y="0123456789ABCDEFGHIJKLMNOPQRSTUV",s=s.replace(/=+$/,"");break;case"Crockford":y="0123456789ABCDEFGHJKMNPQRSTVWXYZ",s=s.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1");break;default:throw new Error("Unknown base32 variant: "+f)}for(var H=s.length,g=0,m=0,x=0,o=new Uint8Array(5*H/8|0),k=0;k<H;k++)m=m<<5|c(y,s[k]),(g+=5)>=8&&(o[x++]=m>>>g-8&255,g-=8);return o.buffer}},function(j,T){j.exports=function(c,s,f){var y,H;switch(f=f||{},s){case"RFC3548":case"RFC4648":y="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",H=!0;break;case"RFC4648-HEX":y="0123456789ABCDEFGHIJKLMNOPQRSTUV",H=!0;break;case"Crockford":y="0123456789ABCDEFGHJKMNPQRSTVWXYZ",H=!1;break;default:throw new Error("Unknown base32 variant: "+s)}for(var g=f.padding!==void 0?f.padding:H,m=c.byteLength,x=new Uint8Array(c),o=0,k=0,w="",_=0;_<m;_++)for(k=k<<8|x[_],o+=8;o>=5;)w+=y[k>>>o-5&31],o-=5;if(o>0&&(w+=y[k<<5-o&31]),g)for(;w.length%8!=0;)w+="=";return w}},function(j,T,c){var s,f,y,H,g,m,x,o;j.exports=(o=c(0),f=(s=o).lib,y=f.WordArray,H=f.Hasher,g=s.algo,m=[],x=g.SHA1=H.extend({_doReset:function(){this._hash=new y.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(k,w){for(var _=this._hash.words,O=_[0],S=_[1],d=_[2],a=_[3],l=_[4],p=0;p<80;p++){if(p<16)m[p]=0|k[w+p];else{var v=m[p-3]^m[p-8]^m[p-14]^m[p-16];m[p]=v<<1|v>>>31}var b=(O<<5|O>>>27)+l+m[p];b+=p<20?1518500249+(S&d|~S&a):p<40?1859775393+(S^d^a):p<60?(S&d|S&a|d&a)-1894007588:(S^d^a)-899497514,l=a,a=d,d=S<<30|S>>>2,S=O,O=b}_[0]=_[0]+O|0,_[1]=_[1]+S|0,_[2]=_[2]+d|0,_[3]=_[3]+a|0,_[4]=_[4]+l|0},_doFinalize:function(){var k=this._data,w=k.words,_=8*this._nDataBytes,O=8*k.sigBytes;return w[O>>>5]|=128<<24-O%32,w[14+(O+64>>>9<<4)]=Math.floor(_/4294967296),w[15+(O+64>>>9<<4)]=_,k.sigBytes=4*w.length,this._process(),this._hash},clone:function(){var k=H.clone.call(this);return k._hash=this._hash.clone(),k}}),s.SHA1=H._createHelper(x),s.HmacSHA1=H._createHmacHelper(x),o.SHA1)},function(j,T,c){var s;j.exports=(s=c(0),(function(f){var y=s,H=y.lib,g=H.WordArray,m=H.Hasher,x=y.algo,o=[],k=[];(function(){function O(l){for(var p=f.sqrt(l),v=2;v<=p;v++)if(!(l%v))return!1;return!0}function S(l){return 4294967296*(l-(0|l))|0}for(var d=2,a=0;a<64;)O(d)&&(a<8&&(o[a]=S(f.pow(d,.5))),k[a]=S(f.pow(d,1/3)),a++),d++})();var w=[],_=x.SHA256=m.extend({_doReset:function(){this._hash=new g.init(o.slice(0))},_doProcessBlock:function(O,S){for(var d=this._hash.words,a=d[0],l=d[1],p=d[2],v=d[3],b=d[4],E=d[5],C=d[6],N=d[7],A=0;A<64;A++){if(A<16)w[A]=0|O[S+A];else{var R=w[A-15],le=(R<<25|R>>>7)^(R<<14|R>>>18)^R>>>3,M=w[A-2],ge=(M<<15|M>>>17)^(M<<13|M>>>19)^M>>>10;w[A]=le+w[A-7]+ge+w[A-16]}var Y=a&l^a&p^l&p,fe=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),V=N+((b<<26|b>>>6)^(b<<21|b>>>11)^(b<<7|b>>>25))+(b&E^~b&C)+k[A]+w[A];N=C,C=E,E=b,b=v+V|0,v=p,p=l,l=a,a=V+(fe+Y)|0}d[0]=d[0]+a|0,d[1]=d[1]+l|0,d[2]=d[2]+p|0,d[3]=d[3]+v|0,d[4]=d[4]+b|0,d[5]=d[5]+E|0,d[6]=d[6]+C|0,d[7]=d[7]+N|0},_doFinalize:function(){var O=this._data,S=O.words,d=8*this._nDataBytes,a=8*O.sigBytes;return S[a>>>5]|=128<<24-a%32,S[14+(a+64>>>9<<4)]=f.floor(d/4294967296),S[15+(a+64>>>9<<4)]=d,O.sigBytes=4*S.length,this._process(),this._hash},clone:function(){var O=m.clone.call(this);return O._hash=this._hash.clone(),O}});y.SHA256=m._createHelper(_),y.HmacSHA256=m._createHmacHelper(_)})(Math),s.SHA256)},function(j,T,c){var s;j.exports=(s=c(0),c(3),(function(){var f=s,y=f.lib.Hasher,H=f.x64,g=H.Word,m=H.WordArray,x=f.algo;function o(){return g.create.apply(g,arguments)}var k=[o(1116352408,3609767458),o(1899447441,602891725),o(3049323471,3964484399),o(3921009573,2173295548),o(961987163,4081628472),o(1508970993,3053834265),o(2453635748,2937671579),o(2870763221,3664609560),o(3624381080,2734883394),o(310598401,1164996542),o(607225278,1323610764),o(1426881987,3590304994),o(1925078388,4068182383),o(2162078206,991336113),o(2614888103,633803317),o(3248222580,3479774868),o(3835390401,2666613458),o(4022224774,944711139),o(264347078,2341262773),o(604807628,2007800933),o(770255983,1495990901),o(1249150122,1856431235),o(1555081692,3175218132),o(1996064986,2198950837),o(2554220882,3999719339),o(2821834349,766784016),o(2952996808,2566594879),o(3210313671,3203337956),o(3336571891,1034457026),o(3584528711,2466948901),o(113926993,3758326383),o(338241895,168717936),o(666307205,1188179964),o(773529912,1546045734),o(1294757372,1522805485),o(1396182291,2643833823),o(1695183700,2343527390),o(1986661051,1014477480),o(2177026350,1206759142),o(2456956037,344077627),o(2730485921,1290863460),o(2820302411,3158454273),o(3259730800,3505952657),o(3345764771,106217008),o(3516065817,3606008344),o(3600352804,1432725776),o(4094571909,1467031594),o(275423344,851169720),o(430227734,3100823752),o(506948616,1363258195),o(659060556,3750685593),o(883997877,3785050280),o(958139571,3318307427),o(1322822218,3812723403),o(1537002063,2003034995),o(1747873779,3602036899),o(1955562222,1575990012),o(2024104815,1125592928),o(2227730452,2716904306),o(2361852424,442776044),o(2428436474,593698344),o(2756734187,3733110249),o(3204031479,2999351573),o(3329325298,3815920427),o(3391569614,3928383900),o(3515267271,566280711),o(3940187606,3454069534),o(4118630271,4000239992),o(116418474,1914138554),o(174292421,2731055270),o(289380356,3203993006),o(460393269,320620315),o(685471733,587496836),o(852142971,1086792851),o(1017036298,365543100),o(1126000580,2618297676),o(1288033470,3409855158),o(1501505948,4234509866),o(1607167915,987167468),o(1816402316,1246189591)],w=[];(function(){for(var O=0;O<80;O++)w[O]=o()})();var _=x.SHA512=y.extend({_doReset:function(){this._hash=new m.init([new g.init(1779033703,4089235720),new g.init(3144134277,2227873595),new g.init(1013904242,4271175723),new g.init(2773480762,1595750129),new g.init(1359893119,2917565137),new g.init(2600822924,725511199),new g.init(528734635,4215389547),new g.init(1541459225,327033209)])},_doProcessBlock:function(O,S){for(var d=this._hash.words,a=d[0],l=d[1],p=d[2],v=d[3],b=d[4],E=d[5],C=d[6],N=d[7],A=a.high,R=a.low,le=l.high,M=l.low,ge=p.high,Y=p.low,fe=v.high,V=v.low,je=b.high,ye=b.low,xe=E.high,me=E.low,ke=C.high,ve=C.low,be=N.high,we=N.low,F=A,z=R,he=le,L=M,ee=ge,Z=Y,Oe=fe,te=V,W=je,U=ye,pe=xe,re=me,ne=ke,oe=ve,Se=be,$=we,I=0;I<80;I++){var de=w[I];if(I<16)var ie=de.high=0|O[S+2*I],J=de.low=0|O[S+2*I+1];else{var Pe=w[I-15],ae=Pe.high,se=Pe.low,Ee=(ae>>>1|se<<31)^(ae>>>8|se<<24)^ae>>>7,Te=(se>>>1|ae<<31)^(se>>>8|ae<<24)^(se>>>7|ae<<25),He=w[I-2],Q=He.high,ce=He.low,Be=(Q>>>19|ce<<13)^(Q<<3|ce>>>29)^Q>>>6,Ae=(ce>>>19|Q<<13)^(ce<<3|Q>>>29)^(ce>>>6|Q<<26),Ce=w[I-7],De=Ce.high,_e=Ce.low,Ne=w[I-16],Ue=Ne.high,Re=Ne.low;ie=(ie=(ie=Ee+De+((J=Te+_e)>>>0<Te>>>0?1:0))+Be+((J+=Ae)>>>0<Ae>>>0?1:0))+Ue+((J+=Re)>>>0<Re>>>0?1:0),de.high=ie,de.low=J}var G,Ie=W&pe^~W&ne,ze=U&re^~U&oe,Ke=F&he^F&ee^he&ee,We=z&L^z&Z^L&Z,Me=(F>>>28|z<<4)^(F<<30|z>>>2)^(F<<25|z>>>7),Fe=(z>>>28|F<<4)^(z<<30|F>>>2)^(z<<25|F>>>7),Ge=(W>>>14|U<<18)^(W>>>18|U<<14)^(W<<23|U>>>9),Ve=(U>>>14|W<<18)^(U>>>18|W<<14)^(U<<23|W>>>9),e=k[I],t=e.high,r=e.low,n=Se+Ge+((G=$+Ve)>>>0<$>>>0?1:0),i=Fe+We;Se=ne,$=oe,ne=pe,oe=re,pe=W,re=U,W=Oe+(n=(n=(n=n+Ie+((G+=ze)>>>0<ze>>>0?1:0))+t+((G+=r)>>>0<r>>>0?1:0))+ie+((G+=J)>>>0<J>>>0?1:0))+((U=te+G|0)>>>0<te>>>0?1:0)|0,Oe=ee,te=Z,ee=he,Z=L,he=F,L=z,F=n+(Me+Ke+(i>>>0<Fe>>>0?1:0))+((z=G+i|0)>>>0<G>>>0?1:0)|0}R=a.low=R+z,a.high=A+F+(R>>>0<z>>>0?1:0),M=l.low=M+L,l.high=le+he+(M>>>0<L>>>0?1:0),Y=p.low=Y+Z,p.high=ge+ee+(Y>>>0<Z>>>0?1:0),V=v.low=V+te,v.high=fe+Oe+(V>>>0<te>>>0?1:0),ye=b.low=ye+U,b.high=je+W+(ye>>>0<U>>>0?1:0),me=E.low=me+re,E.high=xe+pe+(me>>>0<re>>>0?1:0),ve=C.low=ve+oe,C.high=ke+ne+(ve>>>0<oe>>>0?1:0),we=N.low=we+$,N.high=be+Se+(we>>>0<$>>>0?1:0)},_doFinalize:function(){var O=this._data,S=O.words,d=8*this._nDataBytes,a=8*O.sigBytes;return S[a>>>5]|=128<<24-a%32,S[30+(a+128>>>10<<5)]=Math.floor(d/4294967296),S[31+(a+128>>>10<<5)]=d,O.sigBytes=4*S.length,this._process(),this._hash.toX32()},clone:function(){var O=y.clone.call(this);return O._hash=this._hash.clone(),O},blockSize:32});f.SHA512=y._createHelper(_),f.HmacSHA512=y._createHmacHelper(_)})(),s.SHA512)},function(j,T,c){c.r(T);var s,f=c(0),y=c.n(f),H=c(4),g=c.n(H),m=c(5),x=c.n(m),o=c(6),k=c.n(o),w=c(2),_=c.n(w);function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(n){d(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e){return Object.keys(e).map((function(t){return e[t]}))}(function(e){e.SHA1="sha1",e.SHA256="sha256",e.SHA512="sha512"})(s||(s={}));var p,v=l(s);(function(e){e.ASCII="ascii",e.BASE64="base64",e.HEX="hex",e.LATIN1="latin1",e.UTF8="utf8"})(p||(p={}));var b,E=l(p);(function(e){e.HOTP="hotp",e.TOTP="totp"})(b||(b={}));var C=l(b),N=function(){throw new Error("Please provide an options.createDigest implementation.")};function A(e){return/^(\d+)$/.test(e)}function R(e,t,r){if(e.length>=t)return e;var n=Array(t+1).join(r);return"".concat(n).concat(e).slice(-1*t)}function le(e){var t="otpauth://".concat(e.type,"/{labelPrefix}:{accountName}?secret={secret}{query}"),r=[];if(C.indexOf(e.type)<0)throw new Error("Expecting options.type to be one of ".concat(C.join(", "),". Received ").concat(e.type,"."));if(e.type==="hotp"){if(e.counter==null||typeof e.counter!="number")throw new Error('Expecting options.counter to be a number when options.type is "hotp".');r.push("&counter=".concat(e.counter))}return e.type==="totp"&&e.step&&r.push("&period=".concat(e.step)),e.digits&&r.push("&digits=".concat(e.digits)),e.algorithm&&r.push("&algorithm=".concat(e.algorithm.toUpperCase())),e.issuer&&r.push("&issuer=".concat(encodeURIComponent(e.issuer))),t.replace("{labelPrefix}",encodeURIComponent(e.issuer||e.accountName)).replace("{accountName}",encodeURIComponent(e.accountName)).replace("{secret}",e.secret).replace("{query}",r.join(""))}function M(e){return(M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function ge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Y(e,t){return!t||M(t)!=="object"&&typeof t!="function"?(function(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r})(e):t}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function V(e,t){return(V=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r})(e,t)}function je(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),r.push.apply(r,n)}return r}function ye(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xe(e){if(typeof e.createDigest!="function")throw new Error("Expecting options.createDigest to be a function.");if(typeof e.createHmacKey!="function")throw new Error("Expecting options.createHmacKey to be a function.");if(typeof e.digits!="number")throw new Error("Expecting options.digits to be a number.");if(!e.algorithm||v.indexOf(e.algorithm)<0)throw new Error("Expecting options.algorithm to be one of ".concat(v.join(", "),". Received ").concat(e.algorithm,"."));if(!e.encoding||E.indexOf(e.encoding)<0)throw new Error("Expecting options.encoding to be one of ".concat(E.join(", "),". Received ").concat(e.encoding,"."))}var me=function(e,t,r){return Buffer.from(t,r).toString("hex")};function ke(e){var t=(function(r){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?je(Object(i),!0).forEach((function(u){ye(r,u,i[u])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):je(Object(i)).forEach((function(u){Object.defineProperty(r,u,Object.getOwnPropertyDescriptor(i,u))}))}return r})({},{algorithm:s.SHA1,createHmacKey:me,createDigest:N,digits:6,encoding:p.ASCII},{},e);return xe(t),Object.freeze(t)}function ve(e,t,r){var n=(function(u){return R(u.toString(16),16,"0")})(t),i=r.createHmacKey(r.algorithm,e,r.encoding);return r.createDigest(r.algorithm,i,n)}function be(e,t,r){return(function(n,i){var u=Buffer.from(n,"hex"),B=15&u[u.length-1],K=((127&u[B])<<24|(255&u[B+1])<<16|(255&u[B+2])<<8|255&u[B+3])%Math.pow(10,i);return R(String(K),i,"0")})(r.digest||ve(e,t,r),r.digits)}function we(e,t,r,n,i){return le({algorithm:i.algorithm,digits:i.digits,type:b.HOTP,accountName:e,counter:n,issuer:t,secret:r})}var F=(function(e){function t(){return(function(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")})(this,t),Y(this,fe(t).apply(this,arguments))}var r,n;return(function(i,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(u&&u.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),u&&V(i,u)})(t,e),r=t,(n=[{key:"create",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new t(i)}},{key:"allOptions",value:function(){return ke(this.options)}},{key:"generate",value:function(i,u){return be(i,u,this.allOptions())}},{key:"check",value:function(i,u,B){return(function(K,X,ue,Xe){return!!A(K)&&K===be(X,ue,Xe)})(i,u,B,this.allOptions())}},{key:"verify",value:function(i){if(M(i)!=="object")throw new Error("Expecting argument 0 of verify to be an object");return this.check(i.token,i.secret,i.counter)}},{key:"keyuri",value:function(i,u,B,K){return we(i,u,B,K,this.allOptions())}}])&&ge(r.prototype,n),t})((function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(function(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")})(this,e),this._defaultOptions=Object.freeze(S({},n)),this._options=Object.freeze({})}var t,r;return t=e,(r=[{key:"create",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new e(n)}},{key:"clone",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=this.create(S({},this._defaultOptions,{},n));return i.options=this._options,i}},{key:"allOptions",value:function(){return this.options}},{key:"resetOptions",value:function(){this._options=Object.freeze({})}},{key:"options",get:function(){return Object.freeze(S({},this._defaultOptions,{},this._options))},set:function(n){this._options=Object.freeze(S({},this._options,{},n))}}])&&a(t.prototype,r),e})());function z(e){return(z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function he(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function L(e,t){return!t||z(t)!=="object"&&typeof t!="function"?(function(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r})(e):t}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Z(e,t){return(Z=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r})(e,t)}function Oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Oe(Object(r),!0).forEach((function(n){W(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oe(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function W(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U(e,t){return(function(r){if(Array.isArray(r))return r})(e)||(function(r,n){if(Symbol.iterator in Object(r)||Object.prototype.toString.call(r)==="[object Arguments]"){var i=[],u=!0,B=!1,K=void 0;try{for(var X,ue=r[Symbol.iterator]();!(u=(X=ue.next()).done)&&(i.push(X.value),!n||i.length!==n);u=!0);}catch(Xe){B=!0,K=Xe}finally{try{u||ue.return==null||ue.return()}finally{if(B)throw K}}return i}})(e,t)||(function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")})()}function pe(e){if(typeof e=="number")return[Math.abs(e),Math.abs(e)];if(Array.isArray(e)){var t=U(e,2),r=t[0],n=t[1];if(typeof r=="number"&&typeof n=="number")return[Math.abs(r),Math.abs(n)]}throw new Error("Expecting options.window to be an number or [number, number].")}function re(e){if(xe(e),pe(e.window),typeof e.epoch!="number")throw new Error("Expecting options.epoch to be a number.");if(typeof e.step!="number")throw new Error("Expecting options.step to be a number.")}var ne=function(e,t,r){var n=e.length,i=Buffer.from(e,t).toString("hex");if(n<r){var u=new Array(r-n+1).join(i);return Buffer.from(u,"hex").slice(0,r).toString("hex")}return i},oe=function(e,t,r){switch(e){case s.SHA1:return ne(t,r,20);case s.SHA256:return ne(t,r,32);case s.SHA512:return ne(t,r,64);default:throw new Error("Expecting algorithm to be one of ".concat(v.join(", "),". Received ").concat(e,"."))}};function Se(e){var t=te({},{algorithm:s.SHA1,createDigest:N,createHmacKey:oe,digits:6,encoding:p.ASCII,epoch:Date.now(),step:30,window:0},{},e);return re(t),Object.freeze(t)}function $(e,t){var r,n;return be(e,(r=t.epoch,n=t.step,Math.floor(r/n/1e3)),t)}function I(e,t,r,n){var i=[];if(n===0)return i;for(var u=1;u<=n;u++){var B=t*u*r;i.push(e+B)}return i}function de(e,t,r){return!!A(e)&&e===$(t,r)}function ie(e,t,r,n){var i=null;return e.some((function(u,B){return!!de(t,r,te({},n,{epoch:u}))&&(i=B+1,!0)})),i}function J(e,t,r){if(de(e,t,r))return 0;var n,i,u,B,K,X=(n=r.epoch,i=r.step,u=r.window,B=pe(u),{past:I(n,-1,K=1e3*i,B[0]),future:I(n,1,K,B[1])}),ue=ie(X.past,e,t,r);return ue!==null?-1*ue:ie(X.future,e,t,r)}function Pe(e,t){return Math.floor(e/1e3)%t}function ae(e,t,r,n){return le({algorithm:n.algorithm,digits:n.digits,step:n.step,type:b.TOTP,accountName:e,issuer:t,secret:r})}var se=(function(e){function t(){return(function(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")})(this,t),L(this,ee(t).apply(this,arguments))}var r,n;return(function(i,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(u&&u.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),u&&Z(i,u)})(t,e),r=t,(n=[{key:"create",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new t(i)}},{key:"allOptions",value:function(){return Se(this.options)}},{key:"generate",value:function(i){return $(i,this.allOptions())}},{key:"checkDelta",value:function(i,u){return J(i,u,this.allOptions())}},{key:"check",value:function(i,u){return typeof this.checkDelta(i,u)=="number"}},{key:"verify",value:function(i){if(z(i)!=="object")throw new Error("Expecting argument 0 of verify to be an object");return this.check(i.token,i.secret)}},{key:"timeRemaining",value:function(){var i,u,B=this.allOptions();return i=B.epoch,(u=B.step)-Pe(i,u)}},{key:"timeUsed",value:function(){var i=this.allOptions();return Pe(i.epoch,i.step)}},{key:"keyuri",value:function(i,u,B){return ae(i,u,B,this.allOptions())}}])&&he(r.prototype,n),t})(F);function Ee(e){return(Ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function He(e,t){return!t||Ee(t)!=="object"&&typeof t!="function"?(function(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r})(e):t}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function ce(e,t){return(ce=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r})(e,t)}function Be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),r.push.apply(r,n)}return r}function Ae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ce(e){var t=(function(r){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Be(Object(i),!0).forEach((function(u){Ae(r,u,i[u])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):Be(Object(i)).forEach((function(u){Object.defineProperty(r,u,Object.getOwnPropertyDescriptor(i,u))}))}return r})({},{algorithm:s.SHA1,createDigest:N,createHmacKey:oe,digits:6,encoding:p.HEX,epoch:Date.now(),step:30,window:0},{},e);return(function(r){if(re(r),typeof r.keyDecoder!="function")throw new Error("Expecting options.keyDecoder to be a function.");if(r.keyEncoder&&typeof r.keyEncoder!="function")throw new Error("Expecting options.keyEncoder to be a function.")})(t),Object.freeze(t)}function De(e,t){return t.keyEncoder(e,t.encoding)}function _e(e,t){return t.keyDecoder(e,t.encoding)}function Ne(e,t){return De(t.createRandomBytes(e,t.encoding),t)}var Ue=(function(e){function t(){return(function(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")})(this,t),He(this,Q(t).apply(this,arguments))}var r,n;return(function(i,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(u&&u.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),u&&ce(i,u)})(t,e),r=t,(n=[{key:"create",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new t(i)}},{key:"allOptions",value:function(){return Ce(this.options)}},{key:"generate",value:function(i){return(function(u,B){return $(_e(u,B),B)})(i,this.allOptions())}},{key:"checkDelta",value:function(i,u){return(function(B,K,X){return J(B,_e(K,X),X)})(i,u,this.allOptions())}},{key:"encode",value:function(i){return De(i,this.allOptions())}},{key:"decode",value:function(i){return _e(i,this.allOptions())}},{key:"generateSecret",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10;return Ne(i,this.allOptions())}}])&&Te(r.prototype,n),t})(se),Re=y.a.lib.WordArray,G=function(e,t,r){var n=(function(B){switch(B){case s.SHA1:return g.a;case s.SHA256:return x.a;case s.SHA512:return k.a;default:throw new Error("Expecting argument 0 to be one of ".concat(v.join(", "),". Received ").concat(B,"."))}})(e),i=_.a.parse(r),u=_.a.parse(t);return String(n(i,u))},Ie=c(7),ze=c.n(Ie),Ke=c(8),We=c.n(Ke);function Me(e){return(Me=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}c.d(T,"hotp",(function(){return Fe})),c.d(T,"totp",(function(){return Ge})),c.d(T,"authenticator",(function(){return Ve})),(typeof window>"u"?"undefined":Me(window))==="object"&&window.Buffer===void 0&&(window.Buffer=buffer.Buffer);var Fe=new F({createDigest:G}),Ge=new se({createDigest:G}),Ve=new Ue({createDigest:G,createRandomBytes:function(e,t){var r=Re.random(e);return Buffer.from(r.toString(),"hex").toString(t)},keyDecoder:function(e,t){var r=ze()(e.toUpperCase(),"RFC4648");return Buffer.from(r).toString(t)},keyEncoder:function(e,t){return We()(Buffer.from(e,t),"RFC4648",{padding:!1})}})}])}))})(qe)),qe.exports}var $e=et();const Je=P=>{if(!P.secret||P.secret.trim()==="")throw new Error("Secret key is required");$e.authenticator.options={digits:P.digits,period:P.period,algorithm:P.algorithm,window:0};try{const D=$e.authenticator.generate(P.secret);return console.log("otplib generated TOTP:",D,"for secret:",P.secret),D}catch(D){throw console.error("otplib error:",D),new Error(`Failed to generate TOTP: ${D instanceof Error?D.message:"Unknown error"}`)}},tt=()=>{const[P,D]=q.useState({secret:"",digits:6,period:30,algorithm:"sha1"}),[j,T]=q.useState(""),[c,s]=q.useState(30),[f,y]=q.useState(!1);q.useEffect(()=>{if(!P.secret||P.secret.trim()===""){y(!1),T("");return}try{const g=Je(P);console.log("Generated TOTP:",g,"for config:",P),T(g),y(!0)}catch(g){console.error("TOTP generation error:",g),y(!1),T("")}},[P]),q.useEffect(()=>{if(!f)return;const g=setInterval(()=>{s(m=>{if(m<=1)try{const x=Je(P);return console.log("Timer reset - New TOTP:",x),T(x),P.period}catch(x){return console.error("Timer reset TOTP error:",x),y(!1),P.period}return m-1})},1e3);return()=>clearInterval(g)},[f,P.period,P]);const H=g=>{D(g),s(g.period)};return h.jsx("div",{className:"totp-generator",children:h.jsxs("div",{className:"generator-container",children:[h.jsx(Ye,{config:P,onConfigChange:H}),h.jsx(Le,{totp:j,timeRemaining:c,period:P.period,isValid:f})]})})},Qe=q.createContext(void 0),rt=()=>{const P=q.useContext(Qe);if(P===void 0)throw new Error("useTheme must be used within a ThemeProvider");return P},nt=({children:P})=>{const[D,j]=q.useState(()=>{const c=localStorage.getItem("theme");return c||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});q.useEffect(()=>{localStorage.setItem("theme",D),document.documentElement.setAttribute("data-theme",D)},[D]);const T=()=>{j(c=>c==="light"?"dark":"light")};return h.jsx(Qe.Provider,{value:{theme:D,toggleTheme:T},children:P})},ot=()=>{const{theme:P,toggleTheme:D}=rt();return h.jsx("button",{className:"theme-toggle",onClick:D,"aria-label":`Switch to ${P==="light"?"dark":"light"} mode`,title:`Switch to ${P==="light"?"dark":"light"} mode`,children:P==="light"?h.jsx("svg",{className:"theme-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:h.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}):h.jsxs("svg",{className:"theme-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("circle",{cx:"12",cy:"12",r:"5"}),h.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]})})};function at(){return h.jsx(nt,{children:h.jsxs("div",{className:"App",children:[h.jsx(ot,{}),h.jsxs("header",{className:"app-header",children:[h.jsx("h1",{children:"TOTP Generator"}),h.jsx("p",{children:"Generate Time-based One-Time Passwords"})]}),h.jsx("main",{children:h.jsx(tt,{})}),h.jsx("footer",{className:"app-footer",children:h.jsx("p",{children:"© 2024 TOTP Generator. Secure and reliable."})})]})})}export{at as default};
